    <!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="author" content="Cameron Roach">
		<meta name="description" content="A data science blog">
		<meta name="generator" content="Hugo 0.21" />
		<title>tidyverse: readr &middot; Cameron&#39;s blog</title>
		<link rel="shortcut icon" href="/images/favicon.ico">
		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/highlight.css">
		

		
		<link rel="stylesheet" href="/css/font-awesome.min.css">
		

		
		<link href="/index.xml" rel="alternate" type="application/rss+xml" title="Cameron&#39;s blog" />
		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='/'> <span class="arrow">←</span>Home</a>
	
	<a href='/post'>Archive</a>
	<a href='/tags'>Tags</a>
	<a href='/about'>About</a>

	

	
	<a class="cta" href="/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>
                        tidyverse: readr
                    </h1>
                    <h2 class="headline">
                    Oct 17, 2017 10:23
                    · 806 words
                    · 4 minutes read
                      <span class="tags">
                      
                      
                          
                              <a href="/tags/r">R</a>
                          
                              <a href="/tags/tutorial">Tutorial</a>
                          
                              <a href="/tags/tidyverse">tidyverse</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                <section id="post-body">
                    <p><em>Update (21/10/2017): This is all under construction atm. Rewriting this post and figuring out some syntax highlighting issues.</em></p>
<p>Despite appearing fairly innocuous, loading data can be one of the most frustrating challenges when starting a data science project. Missing values, trailing commas, superfluous quotes in strings and many other issues can all cause headaches when reading a csv file. I’m sure many an aspiring data scientist has been left feeling discouraged after falling at this early hurdle - I know I have.</p>
<p>This post introduces some basics of loading data using a csv. It assumes that you’ve managed to get your data into a reasonable format without any of the above issues. I recommend viewing your csv in a text editor such as Notepad++ or Atom before attempting any coding. Be wary of excel as it can hide (and sometimes introduce) problems with csv files.</p>
<div id="packages" class="section level2">
<h2>Packages</h2>
<p>This tutorial will primarily look at R’s <code>readr</code> package. This package contains the <code>read_csv</code> function which is similar to base R’s <code>read.csv</code> function, but with some enhancements.</p>
</div>
<div id="load-the-data" class="section level2">
<h2>Load the data</h2>
<div id="getting-your-working-directory-right" class="section level3">
<h3>Getting your working directory right</h3>
<p><strong>TODO</strong></p>
<ul>
<li><code>getwd</code> <code>setwd</code></li>
<li>Always try to reference folders within the current working directory in case project needs to be moved.</li>
<li>Can avoid the set/get working directory difficulties by using projects in RStudio.</li>
</ul>
</div>
<div id="using-readr" class="section level3">
<h3>Using readr</h3>
<p>If you haven’t already, install the required package by running</p>
<pre class="r"><code>install.packages(&quot;readr&quot;)</code></pre>
<p>The data can be loaded with the code below. Here I have my data stored in a folder called “data” in the current working directory. I recommend structuring code so that paths relative to your current working directory are used. That way, if you ever need to copy your project to another computer or directory, you can simply copy the entire directory and still have everything working. Nothing will work if absolute paths (e.g. /Users/cameron/GitHub/blog-post/data) are used and the project needs to be moved.</p>
<pre class="r"><code>require(readr)</code></pre>
<pre class="r"><code>csv_data &lt;- read_csv(file = &quot;data/2017-10-17-data.csv&quot;)
## Parsed with column specification:
## cols(
##   Date = col_character(),
##   Project = col_character(),
##   Income = col_integer()
## )</code></pre>
<p>We see from these messages that <code>read_csv</code> has determined the Date and Project columns are character types whereas Income is integer. The data looks like</p>
<pre class="r"><code>csv_data
## # A tibble: 14 x 3
##          Date Project  Income
##         &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
##  1   1/1/2010       A 1003412
##  2  5/12/2011       A   23421
##  3  13/1/2010       A 1003412
##  4  1/12/2011       A   23421
##  5  21/1/2010       A 1003412
##  6 12/12/2011       A   23421
##  7  31/1/2010       B 1003412
##  8  1/12/2011       B   23421
##  9  23/1/2010       B 1003412
## 10 30/13/2011       C   23421
## 11  11/1/2010       C 1003412
## 12 21/12/2011    &lt;NA&gt;   23421
## 13  12/1/2010       A 1003412
## 14 11/12/2011       A   23421</code></pre>
<p>One nice thing about <code>read_csv</code> compared to <code>read.csv</code> is data is imported as a tibble rather than a data.frame. Tibbles have a few nice features such as only showing the top few rows which is handy if you are dealing with a lot of data. I’ve accidentally filled my console by forgetting to print <code>head(csv_data)</code> many times. Another nice touch is character columns are imported as characters rather than factors. Factors can be useful, but they are also fiddly to deal with especially for newcomers to R.</p>
</div>
</div>
<div id="some-extras" class="section level2">
<h2>Some extras</h2>
<div id="column-type-specification" class="section level3">
<h3>Column type specification</h3>
<p>One problem with our imported data is the Date column has been read as a string. Conveniently, <code>readr</code> allows us to specify the data type of each column using the <code>col_types</code> argument and <code>cols</code> function.</p>
<pre class="r"><code>csv_data &lt;- read_csv(file = &quot;data/2017-10-17-data.csv&quot;,
                     col_types = cols(
                       Date = col_date(format = &quot;%d/%m/%Y&quot;),
                       Project = col_character(),
                       Income = col_integer()
                       )
                     )
## Warning in rbind(names(probs), probs_f): number of columns of result is not
## a multiple of vector length (arg 2)
## Warning: 1 parsing failure.
## row # A tibble: 1 x 5 col     row   col   expected     actual                       file expected   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;                      &lt;chr&gt; actual 1    10  Date valid date 30/13/2011 &#39;data/2017-10-17-data.csv&#39; file # A tibble: 1 x 5</code></pre>
<p>Remembering the correct date specification is a real pain (<a href="http://strftime.net/">this</a> can be useful). Personally I find it easier to use the <code>lubridate</code> and <code>dplyr</code> packages to convert strings into dates, but that’s a topic for another tutorial!</p>
</div>
<div id="white-space-trimming" class="section level3">
<h3>White space trimming</h3>
<p><strong>TODO</strong></p>
</div>
</div>
<div id="in-summary" class="section level2">
<h2>In summary</h2>
<p>The correctly formatted data is shown below. One of the dates was invalid (30/13/2011) and so an <code>NA</code> value was returned.</p>
<pre class="r"><code>csv_data
## # A tibble: 14 x 3
##          Date Project  Income
##        &lt;date&gt;   &lt;chr&gt;   &lt;int&gt;
##  1 2010-01-01       A 1003412
##  2 2011-12-05       A   23421
##  3 2010-01-13       A 1003412
##  4 2011-12-01       A   23421
##  5 2010-01-21       A 1003412
##  6 2011-12-12       A   23421
##  7 2010-01-31       B 1003412
##  8 2011-12-01       B   23421
##  9 2010-01-23       B 1003412
## 10         NA       C   23421
## 11 2010-01-11       C 1003412
## 12 2011-12-21    &lt;NA&gt;   23421
## 13 2010-01-12       A 1003412
## 14 2011-12-11       A   23421</code></pre>
</div>

                </section>
            </article>

            

            
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//camroach87-github-io.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



            

            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://github.com/camroach87">
        <i class="fa fa-github-square"></i>
    </a>
    
    <a class="symbol" href="https://www.linkedin.com/in/cameron-roach-00873b69/">
        <i class="fa fa-linkedin-square"></i>
    </a>
    
    <a class="symbol" href="https://twitter.com/camroach87">
        <i class="fa fa-twitter-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2017 <i class="fa fa-heart" aria-hidden="true"></i> Cameron Roach
    
    </p>
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

        </section>

        <script src="/js/jquery-2.2.4.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-108233353-1', 'auto');
ga('send', 'pageview');
</script>





    </body>
</html>
