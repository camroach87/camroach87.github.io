    <!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="author" content="Cameron Roach">
		<meta name="description" content="A data science blog">
		<meta name="generator" content="Hugo 0.21" />
		<title>tidyverse: readr &middot; Cameron&#39;s blog</title>
		<link rel="shortcut icon" href="/images/favicon.ico">
		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/highlight.css">
		

		
		<link rel="stylesheet" href="/css/font-awesome.min.css">
		

		
		<link href="/index.xml" rel="alternate" type="application/rss+xml" title="Cameron&#39;s blog" />
		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='/'> <span class="arrow">←</span>Home</a>
	
	<a href='/post'>Archive</a>
	<a href='/tags'>Tags</a>
	<a href='/about'>About</a>

	

	
	<a class="cta" href="/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>
                        tidyverse: readr
                    </h1>
                    <h2 class="headline">
                    Oct 17, 2017 10:23
                    · 685 words
                    · 4 minutes read
                      <span class="tags">
                      
                      
                          
                              <a href="/tags/r">R</a>
                          
                              <a href="/tags/tutorial">Tutorial</a>
                          
                              <a href="/tags/tidyverse">tidyverse</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                <section id="post-body">
                    <p>Loading data can be the most innocuous and frustrating challenge when starting a data science project. Missing values, trailing commas, superfluous quotes in strings and many other issues can all cause headaches when trying to read a csv file.</p>
<p>This post assumes that you’ve managed to get your data into a reasonable format. The above points are a good place to start if you are having issues. If you can’t work out why your data won’t load always try viewing it in a text editor such as Notepad++ or Atom. Be wary of excel as it can hide (and sometimes introduce) problems with csv files.</p>
<div id="packages" class="section level2">
<h2>Packages</h2>
<p>This tutorial will primarily look at R’s <code>readr</code> package. This package contains the <code>read_csv</code> function which is similar to base R’s <code>read.csv</code> function, but with some enhancements.</p>
<!-- We'll also briefly use the `lubridate` package to convert some strings to usable time formats. This package is wondefully intuitive, so we won't need to spend long learning it. -->
</div>
<div id="load-the-data" class="section level2">
<h2>Load the data</h2>
<p>If you haven’t already, install the required packages by running</p>
<pre class="r"><code>install.packages(c(&quot;readr&quot;, &quot;lubridate&quot;))</code></pre>
<p>The data can be loaded with the code below. The two dots (..) in the file name indicate that we wish to move up a folder from our current working directory. If you’re unsure of which directory is currently in use run the <code>getwd()</code> command to check.</p>
<pre class="r"><code>require(readr)
require(lubridate)</code></pre>
<pre class="r"><code>csv_data &lt;- read_csv(file = &quot;../../data/2017-10-17-data.csv&quot;)
## Parsed with column specification:
## cols(
##   Date = col_character(),
##   Project = col_character(),
##   Income = col_integer()
## )</code></pre>
<p>We see from these messages that <code>read_csv</code> has determined the Date and Project columns are character types whereas Income is integer. The data looks like</p>
<pre class="r"><code>csv_data
## # A tibble: 14 x 3
##          Date Project  Income
##         &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
##  1   1/1/2010       A 1003412
##  2  5/12/2011       A   23421
##  3  13/1/2010       A 1003412
##  4  1/12/2011       A   23421
##  5  21/1/2010       A 1003412
##  6 12/12/2011       A   23421
##  7  31/1/2010       B 1003412
##  8  1/12/2011       B   23421
##  9  23/1/2010       B 1003412
## 10 30/13/2011       C   23421
## 11  11/1/2010       C 1003412
## 12 21/12/2011    &lt;NA&gt;   23421
## 13  12/1/2010       A 1003412
## 14 11/12/2011       A   23421</code></pre>
<p>One nice thing about <code>read_csv</code> compared to <code>read.csv</code> is that the data is imported as a tibble rather than a data.frame. Tibbles have a few nice features such as only showing the top few rows which is handy if you are dealing with a lot of data. I’ve accidentally filled my console by forgetting to print <code>head(csv_data)</code> many times. Another nice touch is character columns are imported as characters rather than factors. Factors can be useful, but they are also fiddly to deal with, especially for newcomers to R.</p>
</div>
<div id="column-type-specification" class="section level2">
<h2>Column type specification</h2>
<p>One problem with how we’ve imported our data is that the Date column has been read as a string. Thankfully, <code>readr</code> allows us to specify the data type of each column.</p>
<pre class="r"><code>csv_data &lt;- read_csv(file = &quot;../../data/2017-10-17-data.csv&quot;,
                     col_types = cols(
                       Date = col_date(format = &quot;%d/%m/%Y&quot;),
                       Project = col_character(),
                       Income = col_integer()
                       )
                     )
## Warning in rbind(names(probs), probs_f): number of columns of result is not
## a multiple of vector length (arg 2)
## Warning: 1 parsing failure.
## row # A tibble: 1 x 5 col     row   col   expected     actual                             file expected   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;                            &lt;chr&gt; actual 1    10  Date valid date 30/13/2011 &#39;../../data/2017-10-17-data.csv&#39; file # A tibble: 1 x 5</code></pre>
<p>Remembering the correct date specification is a real pain (<a href="http://strftime.net/">this</a> site can be useful). Personally I avoid this method and instead use <code>lubrdate</code> and <code>dplyr</code> to convert strings into dates, but that’s a topic for another tutorial.</p>
<p>The correctly formatted data is shown below. Notice that one of the dates was invalid (30/13/2011) and so an <code>NA</code> value was read in.</p>
<pre class="r"><code>csv_data
## # A tibble: 14 x 3
##          Date Project  Income
##        &lt;date&gt;   &lt;chr&gt;   &lt;int&gt;
##  1 2010-01-01       A 1003412
##  2 2011-12-05       A   23421
##  3 2010-01-13       A 1003412
##  4 2011-12-01       A   23421
##  5 2010-01-21       A 1003412
##  6 2011-12-12       A   23421
##  7 2010-01-31       B 1003412
##  8 2011-12-01       B   23421
##  9 2010-01-23       B 1003412
## 10         NA       C   23421
## 11 2010-01-11       C 1003412
## 12 2011-12-21    &lt;NA&gt;   23421
## 13 2010-01-12       A 1003412
## 14 2011-12-11       A   23421</code></pre>
</div>

                </section>
            </article>

            

            
                
            

            

            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://github.com/camroach87">
        <i class="fa fa-github-square"></i>
    </a>
    
    <a class="symbol" href="https://www.linkedin.com/in/cameron-roach-00873b69/">
        <i class="fa fa-linkedin-square"></i>
    </a>
    
    <a class="symbol" href="https://twitter.com/camroach87">
        <i class="fa fa-twitter-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2017 <i class="fa fa-heart" aria-hidden="true"></i> Cameron Roach
    
    </p>
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

        </section>

        <script src="/js/jquery-2.2.4.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>







    </body>
</html>
